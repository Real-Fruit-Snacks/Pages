NAME

guestfs-release-notes
- libguestfs Release Notes

RELEASE NOTES FOR LIBGUESTFS 1.46

The big news in
this release is that the virt tools like
virt-builder(1), virt-cat(1),
virt-customize(1), virt-df(1), and many more
were moved to a new project. The temporary repository for
the new guestfs-tools project is here:
https://github.com/rwmjones/guestfs-tools while we set up a
permanent home for it on gitlab. The tarballs containing the
tools are here:
https://download.libguestfs.org/guestfs-tools/

Spinning out
all of the tools into a new repository has made libguestfs a
bit easier and simpler to build and manage, and allows us to
focus on just being the API.

Note that the
tools guestfish(1) (which is really a "shell
API"), guestmount(1),
libguestfs-test-tool(1) and virt-rescue(1) are
still part of the libguestfs repo.

The not quite
so big news is that we have moved away from FreeNode to
Libera Chat for IRC. The new channel on Libera is called
"#guestfs" (thanks Daniel Berrang&eacute;).

Language
bindings 
Libguestfs is now compatible with Go 1.16, and defines a Go
module (thanks Gianfranco Costamagna).

Memory leaks in
Python APIs that returned structs are fixed (thanks &#26417;
&#20025; ).

Python PyPi
code has been relicensed to LGPLv2+ (from GPLv2+).

Inspection

Inspection of RPM guests now uses librpm instead of trying
to parse the Berkeley DB directly. Since most RPM-based
guests have replaced BDB with sqlite this allows us to read
these newer guests while retaining compatibility with the
older guests (thanks Panu Matilainen).

Inspection of
RHEL 8+ with split /usr configuration has been made more
reliable.

Inspection of
Windows Server 2022 should now work correctly (Yongkui
Guo).

API

New APIs

No new APIs
were added in libguestfs 1.46.

Other API
changes

The output of
the "guestfs_cap_get_file" API has changed
slightly because of changes in the underlying libcap. This
isn&rsquo;t strictly speaking an API break because the new
output is a still valid but more compact description of file
capabilities, but because it is different it may cause
problems for users of the API.

The
"guestfs_mkfs_btrfs" API now ignores the
"allocstart" parameter since it was deprecated by
btrfs 4.14.1 and later removed.

"guestfs_isoinfo_*"
APIs now directly parse the CD Primary Volume Descriptor
instead of using an external tool. The APIs should appear to
work exactly the same (thanks Thomas Schmitt).

You can now
force the appliance to use KVM or fail if not supported (Sam
Eiderman).

Because of a
change to XFS in version 5, disabling lazy-counters no
longer works. The API still works for earlier versions of
XFS (Laszlo Ersek).

Build
changes 
The build now uses and requires PCRE2 (instead of PCRE).

This version
requires libvirt &ge; 7.1.0, if libvirt is enabled.

gnulib is no
longer bundled with libguestfs, making builds from git much
simpler.

Perl
"Sys::Virt" (libvirt bindings for Perl) are no
longer required by libguestfs.

The code has
been compiled with both LTO and GCC -fanalyzer and
many bugs and warnings fixed.

Allow projects
like guestfs-tools and virt-v2v to be compiled with locally
built (but not installed) libguestfs (Laszlo Ersek).

Tests now run
in parallel (many additional fixes by Laszlo Ersek).

Work around
RAID0 regression in Linux 3.14/5.4 (Laszlo Ersek).

Support for
RISC-V (Heinrich Schuchardt).

Support for
building on Alma and Cloud Linux
(&#1040;&#1083;&#1077;&#1082;&#1089;&#1072;&#1085;&#1076;&#1088;
&#1050;&#1088;&#1072;&#1074;&#1095;&#1077;&#1085;&#1082;&#1086;).

Fix to compile
with OCaml 4.12.

The tarball no
longer includes the ChangeLog file. To get a detailed
changelog, please look at the upstream git repository.

Don&rsquo;t
assume bash in the ./configure script (Martin
Kletzander).

Fix
./configure --with-distro option (Alexandre
Iooss).

Various fixes
for qemu 6.1.

Fix creating
appliance dependencies on Debian (Hilko Bengen).

Update
appliance packages on SUSE and several other improvements to
the init script (Olaf Hering).

Internals

We now use the qemu / libvirt feature -cpu max to
select the best CPU to run the appliance. This should
improve performance for things like encrypted disks (Daniel
Berrang&eacute;).

When passing
the appliance filesystem UUID to supermin we now read it
directly out of the appliance instead of using the
file(1) program. This is more reliable, especially as
file often breaks or changed its output.

The qemu
-enable-fips option is no longer used. It was not
needed and has been deprecated by qemu.

On Fedora, pull
in glibc-gconv-extra to fix the "guestfs_syslinux"
API (Yongkui Guo).

We no longer
use qemu&rsquo;s sga (Serial Graphics Adapter) option ROM,
instead using the equivalent seabios feature.

Bugs
fixed 
https://bugzilla.redhat.com/2002325

Use -machine graphics=off
instead of sga device

https://bugzilla.redhat.com/2001636

[RFE] libguestfs: Add detection
of AlmaLinux and CloudLinux

https://bugzilla.redhat.com/1997446

osinfo is not correct when
handling windows server 2022 image

https://bugzilla.redhat.com/1990720

syslinux: failed to create
ldlinux.sys

https://bugzilla.redhat.com/1985912

The lstatns function has a
memory leak. (python3)

https://bugzilla.redhat.com/1960217

[Regression] ls: cannot read
symbolic link after running guestmount

https://bugzilla.redhat.com/1949683

virt-v2v: error: inspection
could not detect the source guest (or physical machine)

https://bugzilla.redhat.com/1938982

Move libguestfs from PCRE to
PCRE2

https://bugzilla.redhat.com/1930996

[Regression] lvcreate fails to
wipe signatures again

https://bugzilla.redhat.com/1930133

Virt-v2v can&rsquo;t convert
rhel8 guest whose usr partition is independent

https://bugzilla.redhat.com/1915646

libguestfs-1.44.0 - guestfs
appliance path broken

https://bugzilla.redhat.com/1911177

virt-builder + virt-install
creates a VM that cannot boot fedora 33

https://bugzilla.redhat.com/1766487

libguestfs assumes rpmdb is in
Berkeley DB format

https://bugzilla.redhat.com/1409024

[Debian] Missing db_dump abort
inspection

SEE ALSO

guestfs-examples(1),
guestfs-faq(1), guestfs-performance(1),
guestfs-recipes(1), guestfs-testing(1),
guestfs(3), guestfish(1),
http://libguestfs.org/

AUTHORS

Alexandre Iooss

Daniel P. Berrang&eacute; 
Heinrich Schuchardt 
Hilko Bengen 
Laszlo Ersek 
Martin Kletzander 
Remi Collet 
Richard W.M. Jones 
Sam Eiderman

COPYRIGHT

Copyright (C)
2009-2023 Red Hat Inc.

LICENSE

This program is
free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as
published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is
distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have
received a copy of the GNU General Public License along with
this program; if not, write to the Free Software Foundation,
Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301
USA.

BUGS

To get a list
of bugs against libguestfs, use this link:
https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&product=Virtualization+Tools

To report a new
bug against libguestfs, use this link:
https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&product=Virtualization+Tools

When reporting
a bug, please supply:

&bull;

The version of libguestfs.

&bull;

Where you got libguestfs (eg. which Linux distro,
compiled from source, etc)

&bull;

Describe the bug accurately and give a way to reproduce
it. 

&bull;

Run libguestfs-test-tool(1) and paste the
complete, unedited output into the bug report.