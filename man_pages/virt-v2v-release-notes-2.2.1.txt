NAME

virt-v2v-release-notes
- virt-v2v release notes for 2.2

DESCRIPTION

These are the
release notes for virt-v2v 2.2. This describes
the major changes since 2.0.

Virt-v2v 2.2.0
was released on
Tuesday 10 January 2023.

Security

When running virt-v2v as root, NBD Unix domain sockets in
the v2v directory were openable by any user. We now set the
directory owner so only qemu can access the sockets. See:
https://bugzilla.redhat.com/show_bug.cgi?id=2066773 (thanks
Xiaodai Wang, Dr David Gilbert, Daniel
Berrang&eacute;, Laszlo Ersek).

New
features 
New virt-v2v-inspector(1) tool. This tool can be used
before conversion to collect facts about the source guest,
such as number of disks, and to estimate the disk space
required after conversion.

Add support for
NVMe devices and SATA hard disks when importing from VMware
VMX files (Laszlo Ersek).

Add support for
importing to KubeVirt using the new experimental
-o kubevirt mode.

Windows 11
guests are now supported.

Rocky Linux
guest support has been added (Andrey Drobyshev).

Feature
removed 
The -o json mode was removed. It was intended to be
used with KubeVirt but was never actually used there. Use
-o kubevirt instead.

Other
fixes 
Fix detection of virtio-socket support in Linux guests
(Laszlo Ersek). In addition, a semi-random guest CID is
chosen in -o qemu mode, avoiding an error.

Allow importing
OVAs where the user or group name inside the tarball
contains a space (Ji&#345;&iacute; Sl&eacute;&#382;ka).

Reject guests
with snapshots when using -i vmx -it ssh (Laszlo Ersek).

Improve
documentation for the need to enable PasswordAuthentication
on the server side when importing over SSH (Laszlo
Ersek).

Don&rsquo;t use
the deprecated qemu -balloon option. This caused
deprecation warnings with -o qemu mode. Use
-device instead.

Rewrite device
mapping in -o qemu mode, removing some strange /
non-existent cases like SCSI floppies. This should result in
more consistent device layout when using this mode (Laszlo
Ersek).

Remove more
left over open-vm-tools packages from Linux guests (Tim
Kent).

In -o
rhv-upload mode, do not return until the VM has been
created (Tom&aacute;&scaron; Golembiovsk&yacute;).

Greatly
improved vCPU model handling (Laszlo Ersek).

Document extra
permissions needed for non-admin conversion with
VMware 7 (Ming Xie).

QEMU guest
agent is now installed unconditionally and where possible a
virtio-serial socket is created in the guest metadata
(Laszlo Ersek).

In the various
RHV output modes, the number of disks is now limited to 23.
RHV doesn&rsquo;t support anything greater and would break
(Laszlo Ersek).

-oo
compressed is now working again. It was temporarily
broken in virt-v2v 2.0.

The
documentation no longer advises you to use the dangerous
global "LEGACY crypto" option, but provides more
targeted advice (Laszlo Ersek).

Remove the LVM2
devices file during conversion (Laszlo Ersek).

Add support for
guests using Zstandard compressed kernel modules.

Add the BOCHS
DRM display driver in Linux guest initrd, to avoid a crash
with some guests with graphical boot displays (Laszlo
Ersek).

The UEFI
fallback boot loader is now fixed up if we detect that it
was broken (Laszlo Ersek).

Improve
detection of guests using BIOS boot with GPT partitions so
that we no longer confuse them with UEFI guests (Andrey
Drobyshev).

Fix conflict
between fwcfg and qemufwcfg Windows drivers (Laszlo
Ersek).

Fix Windows 11
support for RHV outputs (Laszlo Ersek).

Build
changes 
Enable malloc debugging in tests with glibc &ge; 2.34.

When using
"make check-valgrind", valgrind output is no
longer written to separate files under tmp/. Instead
it is written to the normal test log file.

We now require
ocamldep -one-line and -all options (added to
ocamldep in Jan 2012).

The OCaml
libvirt bindings are no longer bundled. They must be
available at build time.

Updated the
phony test images. The tests should all pass.

Add
compatibility with OCaml 4.14.

We now require
PCRE2 instead of PCRE.

Internals

New LUKS-on-LVM test added (Laszlo Ersek).

Added
scripts/git.orderfile which orders files when we
prepare patches.

Bugs
fixed 
https://bugzilla.redhat.com/2152465

v2v should set ovirt:id
correctly after coverting windows11/2019/2022 guests to rhv
via -o rhv-upload

https://bugzilla.redhat.com/2151752

qemufwcfg device cannot start
or has no driver after v2v converting windows guests

https://bugzilla.redhat.com/2149863

The version of Win 11/Win
2019/Win 2022 shows incorrect on RHV after virt-v2v
conversion

https://bugzilla.redhat.com/2149811

Copy newer versions of drivers
for Win 11/Win 2019/Win 2022 during virt-v2v conversion

https://bugzilla.redhat.com/2149629

Win 2022 fails to boot after
virt-p2v conversion from physical host with nvme disk

https://bugzilla.redhat.com/2131123

RHEL7 UEFI guest turns into
black after v2v conversion

https://bugzilla.redhat.com/2116811

virt-v2v: error: internal
error: assertion failed at linux_kernels.ml, line 190, char
11

https://bugzilla.redhat.com/2112801

RHEL9 guest hangs during boot
after conversion by virt-p2v

https://bugzilla.redhat.com/2107503

RHEL 8.6 VM with
"qemu64" CPU model can&rsquo;t start because
"the CPU is incompatible with host CPU: Host CPU does
not provide required features: svm"

https://bugzilla.redhat.com/2101665

"/dev/nvme0n1" is not
remapped to "/dev/vda" (etc) in boot config files
such as "/boot/grub2/device.map"

https://bugzilla.redhat.com/2089623

Virt-v2v can&rsquo;t convert
rhel8.6 guest from VMware on rhel8.6

https://bugzilla.redhat.com/2082603

virt-v2v -o qemu prints
cosmetic warning: "warning: short-form boolean option
&rsquo;readonly&rsquo; deprecated"

https://bugzilla.redhat.com/2076013

RHEL9.1 guest can&rsquo;t boot
into OS after v2v conversion

https://bugzilla.redhat.com/2074805

-o qemu mode fails with:
qemu-system-x86_64: -balloon: invalid option and other
problems

https://bugzilla.redhat.com/2074801

do not pass
"--non-bootable --read-write" to "volume
create " in openstack output module

https://bugzilla.redhat.com/2070530

Virt-v2v can&rsquo;t convert
guest when os is installed on nvme disk via vmx+ssh

https://bugzilla.redhat.com/2070186

fix virtio-vsock check (for
Linux guests) in virt-v2v

https://bugzilla.redhat.com/2069768

Import of OVA fails if the
user/group name contains spaces

https://bugzilla.redhat.com/2066773

The /tmp/v2v.XXXX directory has
incorrect permisison if run v2v by root

https://bugzilla.redhat.com/2062360

RFE: Virt-v2v should replace
hairy "enable LEGACY crypto" advice which a more
targeted mechanism

https://bugzilla.redhat.com/2059287

RFE: Rebase virt-v2v to 2.0 in
RHEL 9.1

https://bugzilla.redhat.com/2051564

[RFE]Limiting the maximum
number of disks per guest for v2v conversions

https://bugzilla.redhat.com/2047660

Add &rsquo;--compressed&rsquo;
support in modular v2v

https://bugzilla.redhat.com/2028764

Install the qemu-guest-agent
package during the conversion process

https://bugzilla.redhat.com/2003503

There is virt-v2v warning:
fstrim on guest filesystem /dev/mapper/osprober-linux-sdb1
failed if non-os disk of source guest has few/no inodes
lef

https://bugzilla.redhat.com/1985827

Start or remove VM failure even
v2v has already finished

https://bugzilla.redhat.com/1953286

No error shows when using
virt-v2v -o rhv to convert guest to data domain

https://bugzilla.redhat.com/1938954

-i vmx -it ssh: document
percent encoding in ssh URIs

https://bugzilla.redhat.com/1883802

-i vmx: SATA disks are not
parsed

https://bugzilla.redhat.com/1854275

document that vmx+ssh
"-ip" auth doesn&rsquo;t cover ssh / scp shell
commands

https://bugzilla.redhat.com/1817050

Can&rsquo;t convert guest from
VMware with non-admin account and vddk >=7.0 by
virt-v2v

https://bugzilla.redhat.com/1774386

input_vmx: cleanly reject
guests with snapshots when using "-it ssh"

SEE ALSO

virt-v2v(1),
virt-v2v-release-notes-2.0(1),
virt-v2v-release-notes-1.42(1),
guestfs-release-notes-1.40(1).

AUTHORS

Authors of
virt-v2v 2.2: 
Andrey Drobyshev 
Emilio Herrera 
Ettore Atalan 
Hela Basa 
Jan Kuparinen 
Laszlo Ersek 
Marcin Stanclik 
Ming Xie 
Pavel Borecki 
Piotr Dr&#261;g 
Richard W.M. Jones 
Ricky Tigg 
Temuri Doghonadze 
Tim Kent 
Tom&aacute;&scaron; Golembiovsk&yacute; 
Yuri Chornoivan

COPYRIGHT

Copyright (C)
2009-2023 Red Hat Inc.

LICENSE

This program is
free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as
published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is
distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have
received a copy of the GNU General Public License along with
this program; if not, write to the Free Software Foundation,
Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301
USA.

BUGS

To get a list
of bugs against libguestfs, use this link:
https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&product=Virtualization+Tools

To report a new
bug against libguestfs, use this link:
https://bugzilla.redhat.com/enter_bug.cgi?component=libguestfs&product=Virtualization+Tools

When reporting
a bug, please supply:

&bull;

The version of libguestfs.

&bull;

Where you got libguestfs (eg. which Linux distro,
compiled from source, etc)

&bull;

Describe the bug accurately and give a way to reproduce
it. 

&bull;

Run libguestfs-test-tool(1) and paste the
complete, unedited output into the bug report.