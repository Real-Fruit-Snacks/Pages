NAME

pmNewContextZone
- establish a reporting timezone based on a PMAPI
context

C SYNOPSIS

#include

int
pmNewContextZone(void);

cc ...
-lpcp

DESCRIPTION

The current
reporting timezone affects the timezone used by
pmCtime(3) and pmLocaltime(3).

If the current
PMAPI context is an archive, pmNewContextZone uses
the timezone from the archive label record to set the
current reporting timezone.

If the current
PMAPI context corresponds to a host source of metrics,
pmNewContextZone executes a pmFetch(3) to
retrieve the value for the metric pmcd.timezone and
uses that to set the current reporting timezone.

In both cases,
pmNewContextZone returns a value to identify the
current reporting timezone that may be used in a subsequent
call to pmUseZone(3) to restore this reporting
timezone.

DIAGNOSTICS

PM_ERR_NOCONTEXT

the current PMAPI context is
not valid

other

a return value less than zero indicates a fatal error
from a system call, most likely malloc(3)

SEE ALSO

PMAPI(3),
pmCtime(3), pmFetch(3), pmGetConfig(3),
pmLocaltime(3), pmNewContext(3),
pmNewZone(3), pmUseZone(3),
pmWhichZone(3), pcp.conf(5), pcp.env(5)
and environ(7).