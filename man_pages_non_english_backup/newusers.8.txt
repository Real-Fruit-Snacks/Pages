NEWUSERS(8)                      系统管理命令                      NEWUSERS(8)

名称
       newusers - 批量更新和创建新用户

大纲
       newusers [选项] [文件]

描述
       The newusers command reads a file (or the standard input by default)
       and uses this information to update a set of existing users or to
       create new users. Each line is in the same format as the standard
       password file (see passwd(5)) with the exceptions explained below:

       pw_name:pw_passwd:pw_uid:pw_gid:pw_gecos:pw_dir:pw_shell

       pw_name
           这是用户的用户名。

           It can be the name of a new user or the name of an existing user
           (or a user created before by newusers). In case of an existing
           user, the user's information will be changed, otherwise a new user
           will be created.

       pw_passwd
           此字段将被加密然后用于加密后密码的新值。

       pw_uid
           此字段用于定义用户的 UID。

           If the field is empty, a new (unused) UID will be defined
           automatically by newusers.

           如果此字段包含一个数字，此数字会用于 UID。

           If this field contains the name of an existing user (or the name of
           a user created before by newusers), the UID of the specified user
           will be used.

           如果一个现有用户更改了 UID，此用户的文件所有权需要手动修复。

       pw_gid
           此字段用于定义用户的主组 ID。

           If this field contains the name of an existing group (or a group
           created before by newusers), the GID of this group will be used as
           the primary group ID for the user.

           如果此字段是一个数字，此数字会被用作此用户的主组 ID。如果没有对应此
           GID 的现有组，将会使用此 GID 创建一个新组，名称和用户名相同。

           If this field is empty, a new group will be created with the name
           of the user and a GID will be automatically defined by newusers to
           be used as the primary group ID for the user and as the GID for the
           new group.

           If this field contains the name of a group which does not exist
           (and was not created before by newusers), a new group will be
           created with the specified name and a GID will be automatically
           defined by newusers to be used as the primary group ID for the user
           and GID for the new group.

       pw_gecos
           此字段复制到用户的 GECOS 字段。

       pw_dir
           此字段用于定义用户的主目录。

           If this field does not specify an existing directory, the specified
           directory is created, with ownership set to the user being created
           or updated and its primary group. Note that newusers does not
           create parent directories of the new user's home directory. The
           newusers command will fail to create the home directory if the
           parent directories do not exist, and will send a message to stderr
           informing the user of the failure. The newusers command will not
           halt or return a failure to the calling shell if it fails to create
           the home directory, it will continue to process the batch of new
           users specified.

           If the home directory of an existing user is changed, newusers does
           not move or copy the content of the old directory to the new
           location. This should be done manually.

       pw_shell
           此字段定义了用户的 shell。对此字段不进行任何检查。

       newusers first tries to create or change all the specified users, and
       then write these changes to the user or group databases. If an error
       occurs (except in the final writes to the databases), no changes are
       committed to the databases.

       During this first pass, users are created with a locked password (and
       passwords are not changed for the users which are not created). A
       second pass is used to update the passwords using PAM. Failures to
       update a password are reported, but will not stop the other password
       updates.

       此命令一般用于在大型的应用环境中，对大量账户进行一次性更新。

选项
       The options which apply to the newusers command are:

       --badname
           Allow names that do not conform to standards.

       -h, --help
           显示帮助信息并退出。

       -r, --system
           创建一个系统账户。

           System users will be created with no aging information in
           /etc/shadow, and their numeric identifiers are chosen in the
           SYS_UID_MIN-SYS_UID_MAX range, defined in login.defs, instead of
           UID_MIN-UID_MAX (and their GID counterparts for the creation of
           groups).

       -R, --root CHROOT_DIR
           Apply changes in the CHROOT_DIR directory and use the configuration
           files from the CHROOT_DIR directory. Only absolute paths are
           supported.

CAVEATS
       输入文件必须受到保护，因为它包含未加密的密码。

配置文件
       The following configuration variables in /etc/login.defs change the
       behavior of this tool:

文件
       /etc/passwd
           用户账户信息。

       /etc/shadow
           安全用户账户信息。

       /etc/group
           组账户信息。

       /etc/gshadow
           安全组账户信息。

       /etc/login.defs
           Shadow 密码套件配置。

       /etc/pam.d/newusers
           PAM configuration for newusers.

       /etc/subgid
           Per user subordinate group IDs.

       /etc/subuid
           Per user subordinate user IDs.

参见
       login.defs(5), passwd(1), subgid(5), subuid(5), useradd(8).

shadow-utils 4.13                 2025-04-07                       NEWUSERS(8)