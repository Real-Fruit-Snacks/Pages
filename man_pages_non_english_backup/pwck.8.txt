PWCK(8)                          系统管理命令                          PWCK(8)

名称
       pwck - verify the integrity of password files

大纲
       pwck [选项] [PASSWORDFILE [ SHADOWFILE ]]

描述
       The pwck command verifies the integrity of the users and authentication
       information. It checks that all entries in /etc/passwd and /etc/shadow
       have the proper format and contain valid data. The user is prompted to
       delete entries that are improperly formatted or which have other
       uncorrectable errors.

       检查的项目有：

       •   正确的字段数

       •   一个唯一且有效的用户名

       •   一个有效的用户和组标识符

       •   有效的主组

       •   有效的主目录

       •   有效的登录 shell

       Checks for shadowed password information are enabled when the second
       file parameter SHADOWFILE is specified or when /etc/shadow exists on
       the system.

       这些检查是：

       •   每个密码项都有对应的影子相，反之亦然。

       •   密码在影子化了的文件中指定

       •   影子项有正确的字段数。

       •   影子项在影子文件中是唯一的

       •   最后一次的密码更改时间不是被设成了一个将来的时间。

       The checks for correct number of fields and unique user name are fatal.
       If the entry has the wrong number of fields, the user will be prompted
       to delete the entire line. If the user does not answer affirmatively,
       all further checks are bypassed. An entry with a duplicated user name
       is prompted for deletion, but the remaining checks will still be made.
       All other errors are warnings and the user is encouraged to run the
       usermod command to correct the error.

       The commands which operate on the /etc/passwd file are not able to
       alter corrupted or duplicated entries.  pwck should be used in those
       circumstances to remove the offending entry.

选项
       The -r and -s options cannot be combined.

       The options which apply to the pwck command are:

       --badname
           Allow names that do not conform to standards.

       -h, --help
           显示帮助信息并退出。

       -q, --quiet
           只报告错误。不显示那些不需要用户操作的警告。

       -r, --read-only
           Execute the pwck command in read-only mode.

       -R, --root CHROOT_DIR
           Apply changes in the CHROOT_DIR directory and use the configuration
           files from the CHROOT_DIR directory. Only absolute paths are
           supported.

       -s, --sort
           Sort entries in /etc/passwd and /etc/shadow by UID.

       By default, pwck operates on the files /etc/passwd and /etc/shadow. The
       user may select alternate files with the passwd and shadow parameters.

配置文件
       The following configuration variables in /etc/login.defs change the
       behavior of this tool:

文件
       /etc/group
           组账户信息。

       /etc/passwd
           用户账户信息。

       /etc/shadow
           安全用户账户信息。

退出值
       The pwck command exits with the following values:

       0
           success

       1
           invalid command syntax

       2
           one or more bad password entries

       3
           can't open password files

       4
           can't lock password files

       5
           can't update password files

       6
           can't sort password files

参见
       group(5), grpck(8), passwd(5), shadow(5), usermod(8).

shadow-utils 4.13                 2025-04-07                           PWCK(8)