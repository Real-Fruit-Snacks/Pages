<!DOCTYPE html>
<html>
<head>
    <title>Module Test</title>
</head>
<body>
    <h1>Module Loading Test</h1>
    <div id="output"></div>
    
    <script type="module">
        console.log('Starting module test...');
        
        try {
            // Test importing constants first (simplest module)
            const constants = await import('./js/utils/constants.js');
            console.log('Constants loaded:', constants);
            document.getElementById('output').innerHTML += 'Constants: OK<br>';
            
        } catch (e) {
            console.error('Constants failed:', e);
            document.getElementById('output').innerHTML += 'Constants: FAILED - ' + e.message + '<br>';
        }
        
        try {
            // Test DOM utilities
            const dom = await import('./js/utils/dom.js');
            console.log('DOM loaded:', dom);
            document.getElementById('output').innerHTML += 'DOM: OK<br>';
            
        } catch (e) {
            console.error('DOM failed:', e);
            document.getElementById('output').innerHTML += 'DOM: FAILED - ' + e.message + '<br>';
        }
        
        try {
            // Test base module
            const base = await import('./js/modules/base.js');
            console.log('Base loaded:', base);
            document.getElementById('output').innerHTML += 'Base: OK<br>';
            
        } catch (e) {
            console.error('Base failed:', e);
            document.getElementById('output').innerHTML += 'Base: FAILED - ' + e.message + '<br>';
        }
        
        try {
            // Test security module
            const security = await import('./js/modules/security.js');
            console.log('Security loaded:', security);
            document.getElementById('output').innerHTML += 'Security: OK<br>';
            
        } catch (e) {
            console.error('Security failed:', e);
            document.getElementById('output').innerHTML += 'Security: FAILED - ' + e.message + '<br>';
        }
        
        try {
            // Test storage module (this should work now without circular dependency)
            const storage = await import('./js/modules/storage.js');
            console.log('Storage loaded:', storage);
            document.getElementById('output').innerHTML += 'Storage: OK<br>';
            
        } catch (e) {
            console.error('Storage failed:', e);
            document.getElementById('output').innerHTML += 'Storage: FAILED - ' + e.message + '<br>';
        }
        
        try {
            // Test theme module
            const theme = await import('./js/modules/theme.js');
            console.log('Theme loaded:', theme);
            document.getElementById('output').innerHTML += 'Theme: OK<br>';
            
        } catch (e) {
            console.error('Theme failed:', e);
            document.getElementById('output').innerHTML += 'Theme: FAILED - ' + e.message + '<br>';
        }
        
        try {
            // Test app module
            const app = await import('./js/app.js');
            console.log('App loaded:', app);
            document.getElementById('output').innerHTML += 'App: OK<br>';
            
            // Test making modules available on window
            const { Storage } = await import('./js/modules/storage.js');
            const { Theme } = await import('./js/modules/theme.js');
            const { Security } = await import('./js/modules/security.js');
            
            window.Storage = Storage;
            window.Theme = Theme;
            window.Security = Security;
            window.app = app.default;
            
            document.getElementById('output').innerHTML += 'Window assignments: OK<br>';
            
        } catch (e) {
            console.error('App failed:', e);
            document.getElementById('output').innerHTML += 'App: FAILED - ' + e.message + '<br>';
        }
    </script>
</body>
</html>